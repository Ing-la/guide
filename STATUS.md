# é¡¹ç›®çŠ¶æ€æ€»ç»“

## âœ… å·²å®Œæˆçš„ç•Œé¢

### 1. ç”¨æˆ·ç•Œé¢ (`/dashboard/user`)
- âœ… **å·²åˆ›å»º** - `src/app/dashboard/user/page.tsx`
- æ˜¾ç¤º"åŠŸèƒ½å¼€å‘ä¸­ï¼Œæ•¬è¯·æœŸå¾…..."
- åŒ…å«åŸºæœ¬çš„å¸ƒå±€å’Œè¯´æ˜

### 2. å¯¼æ¸¸ç•Œé¢ (`/dashboard/guide`)
- âœ… **å·²åˆ›å»º** - `src/app/dashboard/guide/page.tsx`
- æ˜¾ç¤º"åŠŸèƒ½å¼€å‘ä¸­ï¼Œæ•¬è¯·æœŸå¾…..."
- åŒ…å«åŸºæœ¬çš„å¸ƒå±€å’Œè¯´æ˜

### 3. ç”¨æˆ·ç®¡ç† - æŸ¥çœ‹å’Œç¼–è¾‘ç•Œé¢ (`/dashboard/users/[id]`)
- âœ… **å·²åˆ›å»º** - `src/app/dashboard/users/[id]/page.tsx`
- å®Œæ•´çš„ç”¨æˆ·è¯¦æƒ…é¡µé¢
- å¯ä»¥æŸ¥çœ‹å’Œç¼–è¾‘ï¼š
  - æ˜µç§°
  - é‚®ç®±ï¼ˆåªè¯»ï¼‰
  - æ‰‹æœºå·
  - è§’è‰²ï¼ˆä¸‹æ‹‰é€‰æ‹©ï¼šç”¨æˆ·/å¯¼æ¸¸/ç®¡ç†å‘˜ï¼‰
  - ç”¨æˆ·IDï¼ˆåªè¯»ï¼‰
  - åˆ›å»ºæ—¶é—´ï¼ˆåªè¯»ï¼‰
  - æ›´æ–°æ—¶é—´ï¼ˆåªè¯»ï¼‰
- å¯ä»¥åˆ é™¤ç”¨æˆ·
- åŒ…å«ç®¡ç†å‘˜æƒé™æ£€æŸ¥

## ğŸ”§ ç™»å½•é—®é¢˜æ’æŸ¥

### å¯èƒ½çš„åŸå› 

1. **`guide_profiles` è¡¨ç¼ºå°‘ `role` å­—æ®µ**
   - å¦‚æœè¿è¡Œ `recreate-all-tables.sql` ä¹‹å‰å°±åˆ›å»ºäº†è¡¨ï¼Œå¯èƒ½ç¼ºå°‘ `role` å­—æ®µ
   - **è§£å†³**ï¼šè¿è¡Œ `supabase/fix-existing-users-role.sql`

2. **`role` å­—æ®µä¸º NULL**
   - ç°æœ‰ç”¨æˆ·çš„ `role` å¯èƒ½ä¸º NULL
   - **è§£å†³**ï¼šè¿è¡Œ `supabase/fix-existing-users-role.sql` ä¼šè‡ªåŠ¨è®¾ç½®ä¸º 'user'

3. **RLS ç­–ç•¥é˜»æ­¢æŸ¥è¯¢**
   - RLS ç­–ç•¥å¯èƒ½é˜»æ­¢ç”¨æˆ·æŸ¥è¯¢è‡ªå·±çš„ profile
   - **è§£å†³**ï¼šç¡®ä¿è¿è¡Œäº† `recreate-all-tables.sql` ä¸­çš„æ‰€æœ‰ RLS ç­–ç•¥

### ä¿®å¤æ­¥éª¤

1. **åœ¨ Supabase Dashboard â†’ SQL Editor ä¸­è¿è¡Œ**ï¼š
   ```sql
   -- å¤åˆ¶ supabase/fix-existing-users-role.sql çš„å…¨éƒ¨å†…å®¹å¹¶è¿è¡Œ
   ```

2. **æ£€æŸ¥ç°æœ‰ç”¨æˆ·çš„ role**ï¼š
   ```sql
   SELECT id, email, nickname, role FROM public.guide_profiles;
   ```

3. **è®¾ç½®ç®¡ç†å‘˜**ï¼ˆå¦‚æœéœ€è¦ï¼‰ï¼š
   ```sql
   UPDATE public.guide_profiles 
   SET role = 'admin' 
   WHERE email = 'admin1@guide.com';
   ```

## ğŸ“ ç™»å½•æµç¨‹

1. ç”¨æˆ·è¾“å…¥é‚®ç®±å’Œå¯†ç 
2. Supabase Auth éªŒè¯ `auth.users` è¡¨ä¸­çš„é‚®ç®±å’Œå¯†ç 
3. éªŒè¯æˆåŠŸåï¼ŒæŸ¥è¯¢ `guide_profiles` è¡¨è·å–ç”¨æˆ·è§’è‰²
4. æ ¹æ®è§’è‰²é‡å®šå‘ï¼š
   - `admin` â†’ `/dashboard`ï¼ˆç®¡ç†åå°ï¼‰
   - `guide` â†’ `/dashboard/guide`ï¼ˆå¯¼æ¸¸ä¸­å¿ƒï¼‰
   - `user` â†’ `/dashboard/user`ï¼ˆç”¨æˆ·ä¸­å¿ƒï¼‰

## ğŸ› å¦‚æœä»ç„¶æ— æ³•ç™»å½•

è¯·æ£€æŸ¥ï¼š

1. **Supabase Dashboard â†’ Logs â†’ Postgres Logs** - æŸ¥çœ‹æ•°æ®åº“é”™è¯¯
2. **æµè§ˆå™¨æ§åˆ¶å°ï¼ˆF12ï¼‰** - æŸ¥çœ‹å‰ç«¯é”™è¯¯
3. **Vercel Dashboard â†’ Logs** - æŸ¥çœ‹æœåŠ¡å™¨é”™è¯¯
4. **ç™»å½•é¡µé¢çš„é”™è¯¯ä¿¡æ¯** - URL å‚æ•°ä¸­çš„ `error` ä¿¡æ¯
